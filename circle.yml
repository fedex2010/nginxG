deployment:
  staging:
    branch: master
    commands:
      - zip -r app.zip *
      - aws s3 cp app.zip s3://garbarino-deploys/nginx/builds/$CIRCLE_SHA1-$CIRCLE_BUILD_NUM.zip
      - aws elasticbeanstalk create-application-version --application-name nginx --version-label $CIRCLE_SHA1-$CIRCLE_BUILD_NUM --source-bundle S3Bucket=garbarino-deploys,S3Key=nginx/builds/$CIRCLE_SHA1-$CIRCLE_BUILD_NUM.zip --region us-west-2
      - aws elasticbeanstalk update-environment --environment-name nginx-staging --version-label $CIRCLE_SHA1-$CIRCLE_BUILD_NUM --region us-west-2