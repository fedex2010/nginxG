server {
    listen 80 default_server;
    location /nginx/health {
        access_log off;
        return 200 'A-OK!';
        # because default content-type is application/octet-stream,
        # browser will offer to "save the file"...
        # the next line allows you to see it in the browser so you can test 
        add_header Content-Type text/plain;
    }
}

server {
    listen 81;
    server_name localhost;

    location = /nginx_stub_status {
        stub_status on;
        access_log   off;
        allow 127.0.0.1;
        deny all;
    }
}

server {
    listen 80;
    server_name garbarino.com garbarino.com.ar www.garbarino.com.ar ;
    location / {
        rewrite ^ https://www.garbarino.com$request_uri permanent;
    }
}

server {
    listen 80;
    server_name enamorados.garbarino.com;
    location / {
        rewrite ^ https://www.garbarino.com$request_uri permanent;
    }
}

server {
        include /etc/nginx/env.conf;

        listen 80;
        server_name catalogos.garbarino.com catalogos.garbarino.com.ar;
        set $webstore Garbarino;

        include /etc/nginx/includes/headers;
        include /etc/nginx/includes/security;

        location / {
            proxy_pass $MICROAPPS_DNS/catalogos$request_uri;
        }

}

server {
        include /etc/nginx/env.conf;

        listen 80;
        server_name mejoresofertas.garbarino.com mejoresofertas.garbarino.com.ar;
        set $webstore Garbarino;

        include /etc/nginx/includes/headers;
        include /etc/nginx/includes/security;

        location / {
            proxy_pass $MICROAPPS_DNS/mejoresofertas$request_uri;
        }

}

server {
        include /etc/nginx/env.conf;

        listen 80;
        server_name clone.garbarino.com;
        set $webstore Garbarino;

        include /etc/nginx/includes/headers;
        include /etc/nginx/includes/security;

        # location /productos {
        #     if ($http_x_gvalid != "true"){
        #         proxy_pass http://seo_proxy_us;
        #         break;
        #     }

        #     include /etc/nginx/includes/prerender;
        #     include /etc/nginx/includes/https;

        #     include /etc/nginx/includes/rewrites;
        #     include /etc/nginx/includes/compu-rewrites;
        #     proxy_pass http://epi_ui_us;

        # }

        location / {
            include /etc/nginx/includes/prerender;
            include /etc/nginx/includes/https;

            include /etc/nginx/includes/rewrites;
            include /etc/nginx/includes/garba-rewrites;
            proxy_pass http://epi_ui_clone_us;
        }


        location ~ ^/(admin|sg|api) {
            include /etc/nginx/env.conf;

            include /etc/nginx/security/*-ips.conf;

            deny all;

            proxy_pass https://epi_api_us;
        }

        location /services/ {
            include /etc/nginx/env.conf;
            proxy_pass https://epi_api_us;
        }
}

server {
        include /etc/nginx/env.conf;

        listen 80;
        server_name ci.garbarino.com ci.garbarino.com.ar;
        set $webstore Garbarino;

        include /etc/nginx/includes/headers;
        include /etc/nginx/includes/security;

        include /etc/nginx/fe/*/*.conf;

        location / {
            include /etc/nginx/includes/prerender;
            include /etc/nginx/includes/https;

            include /etc/nginx/includes/rewrites;
            include /etc/nginx/includes/garba-rewrites;
            proxy_pass http://epi_ui_us;
        }

        location ~ ^/(admin|sg|api) {
            include /etc/nginx/env.conf;

            include /etc/nginx/security/ugarte-ips.conf;
            include /etc/nginx/security/tek-ips.conf;
            include /etc/nginx/security/amazon-ips.conf;

            deny all;

            proxy_pass http://epi_api_us;
        }

        location /services/ {
            include /etc/nginx/env.conf;
            proxy_pass https://epi_api_us;
        }

         location /apps {
            include /etc/nginx/env.conf;
             proxy_pass http://landings_fe_us;
         }
}


server {
        include /etc/nginx/env.conf;

        listen 80;
        server_name fe-staging.garbarino.com;
        set $webstore Garbarino;

        include /etc/nginx/includes/headers;
        include /etc/nginx/includes/security;

        include /etc/nginx/fe/*/*.conf;

        location / {
            include /etc/nginx/includes/prerender;
            include /etc/nginx/includes/https;

            include /etc/nginx/includes/rewrites;
            include /etc/nginx/includes/garba-rewrites;
            proxy_pass http://epi_ui_us;
        }

        location ~ ^/(admin|sg|api) {
            include /etc/nginx/env.conf;

            include /etc/nginx/security/ugarte-ips.conf;
            include /etc/nginx/security/tek-ips.conf;
            include /etc/nginx/security/amazon-ips.conf;

            deny all;

            proxy_pass http://epi_api_us;
        }

        location /services/ {
            include /etc/nginx/env.conf;
            proxy_pass https://epi_api_us;
        }

         location /apps {
            include /etc/nginx/env.conf;
             proxy_pass http://landings_fe_us;
         }
}

server {
        include /etc/nginx/env.conf;

        listen 80;
        server_name www.garbarino.com *.garbarino.com *.garbarino.com.ar;
        set $webstore Garbarino;

        include /etc/nginx/includes/headers;
        include /etc/nginx/includes/security;

        # location /productos {
        #     if ($http_x_gvalid != "true"){
        #         proxy_pass http://seo_proxy_us;
        #         break;
        #     }

        #     include /etc/nginx/includes/prerender;
        #     include /etc/nginx/includes/https;

        #     include /etc/nginx/includes/rewrites;
        #     include /etc/nginx/includes/compu-rewrites;
        #     proxy_pass http://epi_ui_us;

        # }

        location / {
            include /etc/nginx/includes/prerender;
            include /etc/nginx/includes/https;

            include /etc/nginx/includes/rewrites;
            include /etc/nginx/includes/garba-rewrites;
            proxy_pass http://epi_ui_us;
        }


        location ~ ^/(admin|sg|api) {
            include /etc/nginx/env.conf;

            include /etc/nginx/security/*-ips.conf;

            deny all;

            proxy_pass https://epi_api_us;
        }

        location /services/ {
            include /etc/nginx/env.conf;
            proxy_pass https://epi_api_us;
        }

         location /apps {
            include /etc/nginx/env.conf;
             proxy_pass http://landings_fe_us;
         }

        location /listas/ {
            include /etc/nginx/env.conf;
            rewrite ^ https://listas.garbarino.com permanent;            
        }        

}

server {
    listen 80;
    server_name compumundo.com compumundo.com.ar www.compumundo.com ;
    location / {
        rewrite ^ https://www.compumundo.com.ar$request_uri permanent;
    }
}

server {
        include /etc/nginx/env.conf;

        listen 80;
        server_name www.compumundo.com.ar *.compumundo.com.ar *.compumundo.com;
        set $webstore Compumundo;

        include /etc/nginx/includes/headers;
        include /etc/nginx/includes/security;

        # location /productos {
        #     if ($http_x_gvalid != "true"){
        #         proxy_pass http://seo_proxy_us;
        #         break;
        #     }

        #     include /etc/nginx/includes/prerender;
        #     include /etc/nginx/includes/https;

        #     include /etc/nginx/includes/rewrites;
        #     include /etc/nginx/includes/compu-rewrites;
        #     proxy_pass http://epi_ui_us;

        # }

        location / {
            include /etc/nginx/includes/prerender;
            include /etc/nginx/includes/https;

            include /etc/nginx/includes/rewrites;
            include /etc/nginx/includes/compu-rewrites;
            proxy_pass http://epi_ui_us;
        }

        location ~ ^/(admin|sg|api) {
            include /etc/nginx/env.conf;

            include /etc/nginx/security/*-ips.conf;

            deny all;

            proxy_pass https://epi_api_us;
        }

        location /services/ {
            include /etc/nginx/env.conf;
            proxy_pass https://epi_api_us;
        }
}

server {
    listen 80;
    server_name ipoint.com.ar;
    location / {
        rewrite ^ https://www.ipoint.com.ar$request_uri permanent;
    }
}

server {
        include /etc/nginx/env.conf;

        listen 80;
        server_name www.ipoint.com.ar *.ipoint.com.ar;
        set $webstore IPoint;

        include /etc/nginx/includes/headers;
        include /etc/nginx/includes/security;

        # location /productos {
        #     if ($http_x_gvalid != "true"){
        #         proxy_pass http://seo_proxy_us;
        #         break;
        #     }

        #     include /etc/nginx/includes/prerender;
        #     include /etc/nginx/includes/https;

        #     include /etc/nginx/includes/rewrites;
        #     include /etc/nginx/includes/compu-rewrites;
        #     proxy_pass http://epi_ui_us;

        # }

        location / {
            include /etc/nginx/includes/prerender;
            include /etc/nginx/includes/https;

            include /etc/nginx/includes/rewrites;
            include /etc/nginx/includes/ipoint-rewrites;
            proxy_pass http://epi_ui_us;
        }

        location ~ ^/(admin|sg|api) {
            include /etc/nginx/env.conf;

            include /etc/nginx/security/*-ips.conf;

            deny all;

            proxy_pass https://epi_api_us;
        }

        location /services/ {
            include /etc/nginx/env.conf;
            proxy_pass https://epi_api_us;
        }
}
